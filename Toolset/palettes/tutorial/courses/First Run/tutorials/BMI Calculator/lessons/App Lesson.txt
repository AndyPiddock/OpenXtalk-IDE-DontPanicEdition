tutorial "BMI Calculator"

prologue
	In this tutorial we will put together a small app that calculates
	a Body Mass Index (BMI) from a given height and weight, describes
	the result and plots it on a graph.
end prologue

step "Tutorials Intro"
	You can keep track of how much of the tutorial you have completed 
	with this progress bar, and exit the tutorial at any time by 
	clicking on the stop button.
	
	Clicking the fast-forward button will skip to the next important
	concept being introduced in the tutorial. Use this if you don't want 
	to create the whole UI for the app, for example.
action
	interlude
	highlight toolbar "tutorial"
	go to step "Stack Interlude"
end step

skip point

step "Stack Interlude"
	The most fundamental object in LiveCode is the stack. All objects in
	LiveCode live on a stack. So to get started, we will create a new
	stack for our app.
action
	interlude
	go to step "Create Mainstack"
end step

step "Create Mainstack"
	Click on the File menu, and select New Stack > iPhone 4.
action
    highlight menu item "iPhone 4" of menu item "New Stack" of menu "File"
    capture the next new stack as "Mainstack"
    capture the next new card of stack "Mainstack" as "Calculator"
    wait until there is a stack "Mainstack"
	go to step "Set Stack Rect"
end step

step "Set Stack Rect"
	Resize the stack so that it has width 320 and height 480.
action
	add guide "Stack" with rect "0,0,320,480" to stack "Mainstack"
	highlight guide "Stack"
	wait until stack "Mainstack" fits guide "Stack" with tolerance 3
	go to step "Set Stack Properties"
end step

step "Set Stack Properties"
	Click on the toolbar icon to open the property inspector.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for stack "Mainstack"
	go to step "Property Inspector Interlude"
end step

skip point

step "Property Inspector Interlude"
	The Property Inspector is a window that allows you to control the 
	appearance, location and behavior of the objects in your app. 
	
	Properties of objects are grouped into sections. You can hover over 
	the icons at the top of the inspector to see what each section is 
	called.
action
	interlude
	highlight inspector for stack "Mainstack"
	go to step "Set Stack Background Color"
end step

step "Set Stack Background Color"
	Set the background color of the stack to white.
action
	highlight property "backgroundColor" of section "Colors"
	wait until the backgroundColor of stack "Mainstack" is "255,255,255"
	go to step "Set Stack Text Size"
end step 

step "Set Stack Text Size"
	Set the text size of the stack to 18. All objects added to the stack
	will inherit this text size, unless explicitly set on the object.
action
	highlight property "textSize" of section "Text"
	wait until the textSize of stack "Mainstack" is 18
	go to step "Tools Palette Interlude"
end step

skip point

step "Tools Palette Interlude"
	This is the tools palette. It contains all the built-in objects that 
	you can drag out onto your stack, such as buttons, text fields and 
	scrollbars. It also contains more complex controls called widgets. 
	These include a header bar, navigation bar and browser.
action
	interlude
	highlight tools
	go to step "Create Header Widget"
end step

step "Create Header Widget"
	Drag a header bar widget from the tools palette onto your stack.
action
	highlight tool "Create com.livecode.widget.headerBar"
	capture the next new widget of stack "Mainstack" as "Header"
	wait until there is a widget "Header"
	go to step "Set Header Rect"
end step

step "Set Header Rect"
	Position the header bar widget at the top of the stack, as shown.
action
	add guide "Header" with rect "1,1,319,64" to stack "Mainstack"
	highlight guide "Header"
	wait until widget "Header" fits guide "Header" with tolerance 3
	go to step "Open Property Inspector"
end step

step "Open Property Inspector"
	Click on the toolbar icon to open the property inspector for the 
	header bar.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for widget "Header"
	go to step "Set Calculator Header Title"
end step

step "Set Calculator Header Title"
	Set the title of the header widget to "BMI Calculator"
action
	highlight property "headerTitle" of section "Basic"
	wait until the headerTitle of widget "Header" is "BMI Calculator"
	go to step "Set Calculator Header Style"
end step

step "Set Calculator Header Style"
	Set the action style of the header widget to "names"
action
	highlight property "actionStyle" of section "Basic"
	wait until the actionStyle of widget "Header" is "names"
	go to step "Set Calculator Header Actions"
end step

step "Set Calculator Header Actions"
	Set the name of the header widget action to "Clear"
action
	highlight property "headerActions" of section "Basic"
	wait until the actionLabels of widget "Header" is "Clear"
	go to step "Set Calculator Header Left Label"
end step

step "Set Calculator Header Left Label"
	Set the left label of the header widget to empty. Empty is a special
	constant in LiveCode which can represent the empty string.
action
	highlight property "leftLabel" of section "Basic"
	wait until the leftLabel of widget "Header" is ""
	go to step "Set Calculator Header Show Back Icon"
end step

step "Set Calculator Header Show Back Icon"
	Hide the back icon of the header widget.
action
	highlight property "showBackIcon" of section "Basic"
	wait until the showBackIcon of widget "Header" is false
	go to step "Set Calculator Header Show Search Icon"
end step

step "Set Calculator Header Show Search Icon"
	Hide the search icon of the header widget.
action
	highlight property "showSearchIcon" of section "Basic"
	wait until the showSearchIcon of widget "Header" is false
	go to step "Create Navigation Bar Widget"
end step

step "Create Navigation Bar Widget"
	Create a navigation bar widget by dragging it onto your stack from
	the tools palette.
action
	highlight tool "Create com.livecode.widget.navbar"
	capture the next new widget of stack "Mainstack" as "Footer"
	wait until there is a widget "Footer"
	go to step "Set Footer Rect"
end step

step "Set Footer Rect"
	Position the navigation bar widget at the bottom of the stack, as 
	shown.
action
	add guide "Footer" with rect "1,430,319,479" to stack "Mainstack"
	highlight guide "Footer"
	wait until widget "Footer" fits guide "Footer" with tolerance 3
	go to step "Set Footer Properties"
end step

step "Set Footer Properties"
	Open the property inspector for the navigation bar widget.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for widget "Footer"
	go to step "Set Footer Label"
end step

step "Set Footer Label"
	Remove all but one of the navigation bar actions by clicking on the
	delete icons.
	
	Then change the name of the remaining one to "Calculator".
action 
	highlight property "navData" of section "Basic"
	wait until the navLabels of widget "Footer" is "Calculator"
	go to step "Set Footer Icon"
end step

step "Set Footer Icon"
	Set the icon of the Calculator item to the cog icon.
action
	highlight property "navData" of section "Basic"
	wait until the navIcons of widget "Footer" is "cog"
	go to step "Create Entry Graphic"
end step

step "Create Entry Graphic"
	Create a rounded rectangle graphic. This will be the background to
	the height and weight entry fields.
action
	highlight tool "Create Round Rect Graphic"
	capture the next new graphic of stack "Mainstack" as "Entry Background"
	wait until there is a graphic "Entry Background"
	go to step "Set Entry Background Rect"
end step

step "Set Entry Background Rect"
	Resize and position the graphic as shown.
action
	add guide "Background" with rect "14,74,308,228" to stack "Mainstack"
	highlight guide "Background"
	wait until graphic "Entry Background" fits guide "Background" with tolerance 3
	go to step "Set Entry Background Properties"
end step

step "Set Entry Background Properties"
	Open the property inspector for the graphic.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for graphic "Entry Background"
	go to step "Set Entry Background Border"
end step

step "Set Entry Background Border"
	Remove the border of the graphic by setting its line size to 0.
action
	highlight property "lineSize" of section "Basic"
	wait until the lineSize of graphic "Entry Background" is 0
	go to step "Set Entry Background Fill Color"
end step

step "Set Entry Background Fill Color"
	Set the background color of the graphic to "0,128,255".
action
	highlight property "backgroundColor" of section "Colors"
	wait until the backgroundColor of graphic "Entry Background" is "0,128,255"
	go to step "Set Entry Background Blend Level"
end step

step "Set Entry Background Blend Level"
	Set the blendLevel of the graphic to "50"
action
	highlight property "blendLevel" of section "Colors"
	wait until the blendLevel of graphic "Entry Background" is "50"
	go to step "Create Height Label Field"
end step

step "Create Height Label Field"
	Drag a label field from the tools palette onto your stack.
action
	highlight tool "Create Label Field"
	capture the next new field of stack "Mainstack" as "Height Label"
	wait until there is a field "Height Label"
	go to step "Set Height Label Rect"
end step

step "Set Height Label Rect"
	Resize and position the field as shown.
action
	add guide "Label" with rect "28,87,164,117" to stack "Mainstack"
	highlight guide "Label"
	wait until field "Height Label" fits guide "Label" with tolerance 3
	go to step "Set Height Label Properties"
end step

step "Set Height Label Properties"
	Open the property inspector for the label field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Height Label"
	go to step "Set Height Label Text"
end step

step "Set Height Label Text"
	Set the text of the label to "Height (m):"
action
	highlight property "styledText" of section "Basic"
	wait until the text of field "Height Label" is "Height (m):"
	go to step "Create Weight Label Field"
end step

step "Create Weight Label Field"
	Drag a label field from the tools palette onto your stack.
action
	highlight tool "Create Label Field"
	capture the next new field of stack "Mainstack" as "Weight Label"
	wait until there is a field "Weight Label"
	go to step "Set Weight Label Rect"
end step

step "Set Weight Label Rect"
	Resize and position the field as shown.
action
	add guide "Label" with rect "28,127,164,157" to stack "Mainstack"
	highlight guide "Label"
	wait until field "Weight Label" fits guide "Label" with tolerance 3
	go to step "Set Weight Label Properties"
end step

step "Set Weight Label Properties"
	Open the property inspector for the label field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Weight Label"
	go to step "Set Weight Label Text"
end step

step "Set Weight Label Text"
	Set the text of the label to "Weight (kg):"
action
	highlight property "styledText" of section "Basic"
	wait until the text of field "Weight Label" is "Weight (kg):"
	go to step "Create Height Entry Field"
end step

step "Create Height Entry Field"
	Drag an editable text field from the tools palette onto your stack.
action
	highlight tool "Create Field"
	capture the next new field of stack "Mainstack" as "Height Field"
	wait until there is a field "Height Field"
	go to step "Set Height Field Rect"
end step

step "Set Height Field Rect"
	Resize and position the field as shown.
action
	add guide "Entry Field" with rect "185,87,253,117" to stack "Mainstack"
	highlight guide "Entry Field"
	wait until field "Height Field" fits guide "Entry Field" with tolerance 3
	go to step "Set Height Field Properties"
end step

step "Set Height Field Properties"
	Open the property inspector for the field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Height Field"
	go to step "Set Height Field Name"
end step

step "Set Height Field Name"
	Set the name of the field to "height"
action
	highlight property "name" of section "Basic"
	wait until the "name" of field "Height Field" is "height"
	go to step "Create Weight Entry Field"
end step

step "Create Weight Entry Field"
	Drag an editable text field from the tools palette onto your stack.
action
	highlight tool "Create Field"
	capture the next new field of stack "Mainstack" as "Weight Field"
	wait until there is a field "Weight Field"
	go to step "Set Weight Field Rect"
end step

step "Set Weight Field Rect"
	Resize and position the field as shown.
action
	add guide "Entry Field" with rect "185,127,253,157" to stack "Mainstack"
	highlight guide "Entry Field"
	wait until field "Weight Field" fits guide "Entry Field" with tolerance 3
	go to step "Set Weight Field Properties"
end step

step "Set Weight Field Properties"
	Open the property inspector for the field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Weight Field"
	go to step "Set Weight Field Name"
end step

step "Set Weight Field Name"
	Set the name of the field to "weight"
action
	highlight property "name" of section "Basic"
	wait until the "name" of field "Weight Field" is "weight"
	go to step "Create Calculate Graphic"
end step

step "Create Calculate Graphic"
	Drag a rounded rectangle graphic from the tools palette onto your 
	stack.
action
	highlight tool "Create Round Rect Graphic"
	capture the next new graphic of stack "Mainstack" as "Calculate Background"
	wait until there is a graphic "Calculate Background"
	go to step "Set Calculate Graphic Rect"
end step

step "Set Calculate Graphic Rect"
	Resize and position the graphic as shown.
action
	add guide "Calculate Graphic" with rect "23,178,300,216" to stack "Mainstack"
	highlight guide "Calculate Graphic"
	wait until graphic "Calculate Background" fits guide "Calculate Graphic" with tolerance 3
	go to step "Set Calculate Graphic Properties"
end step

step "Set Calculate Graphic Properties"
	Open the property inspector for the graphic.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for graphic "Calculate Background"
	go to step "Set Calculate Graphic Background"
end step

step "Set Calculate Graphic Background"
	Set the backgroundColor of the graphic to "255,255,255"
action
	highlight property "backgroundColor" of section "Colors"
	wait until the "backgroundColor" of graphic "Calculate Background" is "255,255,255"
	go to step "Create Calculate Button"
end step

step "Create Calculate Button"
	Drag a button from the tools palette onto your stack.
action
	highlight tool "Create Button"
	capture the next new button of stack "Mainstack" as "Calculate"
	wait until there is a button "Calculate"
	go to step "Set Calculate Button Rect"
end step

step "Set Calculate Button Rect"
	Resize and position the button as shown.
action
	add guide "Calculate" with rect "23,178,300,216" to stack "Mainstack"
	highlight guide "Calculate"
	wait until button "Calculate" fits guide "Calculate" with tolerance 3
	go to step "Set Calculate Button Properties"
end step

step "Set Calculate Button Properties"
	Open the property inspector for the button.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for button "Calculate"
	go to step "Set Calculate Button Label"
end step

step "Set Calculate Button Label"
	Set the label of the button to "Calculate BMI"
action
	highlight property "label" of section "Basic"
	wait until the label of button "Calculate" is "Calculate BMI"
	go to step "Set Calculate Button Transparency"
end step

step "Set Calculate Button Transparency"
	Set the style of the button to "transparent"
action
	highlight property "style" of section "Basic"
	wait until the style of button "Calculate" is "transparent"
	go to step "Set Calculate Button Border"
end step

step "Set Calculate Button Border"
	Set the borderWidth of the button to 0
action
	highlight property "borderWidth" of section "Basic"
	wait until the borderWidth of button "Calculate" is 0
	go to step "Create Results Field Background"
end step

step "Create Results Field Background"
	Create a rounded rectangle graphic for the background of the results
	fields.
action
	highlight tool "Create Round Rect Graphic"
	capture the next new graphic of stack "Mainstack" as "Results Background"
	wait until there is a graphic "Results Background"
	go to step "Set Results Background Rect"
end step

step "Set Results Background Rect"
	Resize and position the graphic as shown.
action
	add guide "Background" with rect "14,240,308,422" to stack "Mainstack"
	highlight guide "Background"
	wait until graphic "Results Background" fits guide "Background" with tolerance 3
	go to step "Set Results Background Properties"
end step

step "Set Results Background Properties"
	Open the property inspector for the graphic.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for graphic "Results Background"
	go to step "Set Results Background Name"
end step

step "Set Results Background Name"
	Set the name of the graphic to "resultsBG"
action
	highlight property "name" of section "Basic"
	wait until the name of graphic "Results Background" is "resultsBG"
	go to step "Set Results Background Color"
end step

step "Set Results Background Color"
	Set the background color of the graphic to "255,255,255".
action
	highlight property "backgroundColor" of section "Colors"
	wait until the backgroundColor of graphic "Results Background" is "255,255,255"
	go to step "Set Results Background Blend Level"
end step

step "Set Results Background Blend Level"
	Set the blendLevel of the graphic to "50"
action
	highlight property "blendLevel" of section "Colors"
	wait until the blendLevel of graphic "Results Background" is "50"
	go to step "Create Results Label Field"
end step

step "Create Results Label Field"
	Drag a label field from the tools palette onto your stack.
action
	highlight tool "Create Label Field"
	capture the next new field of stack "Mainstack" as "Results Label"
	wait until there is a field "Results Label"
	go to step "Set Results Label Rect"
end step

step "Set Results Label Rect"
	Resize and position the field as shown.
action
	add guide "Label" with rect "112,254,212,284" to stack "Mainstack"
	highlight guide "Label"
	wait until field "Results Label" fits guide "Label" with tolerance 3
	go to step "Set Results Label Properties"
end step

step "Set Results Label Properties"
	Open the property inspector for the label field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Results Label"
	go to step "Set Results Label Text"
end step

step "Set Results Label Text"
	Set the text of the label to "Results"
action
	highlight property "styledText" of section "Basic"
	wait until the text of field "Results Label" is "Results"
	go to step "Set Results Label Text Style"
end step

step "Set Results Label Text Style"
	Set the style of the label text to bold.
action
	highlight property "textStyle" of section "Text"
	wait until the textStyle of field "Results Label" is "bold"
	go to step "Set Results Label Text Alignment"
end step

step "Set Results Label Text Alignment"
	Set the alignment of the label text to center.
action
	highlight property "textAlign" of section "Text"
	wait until the textAlign of field "Results Label" is "center"
	go to step "Create Results Field"
end step

step "Create Results Field"
	Drag a label field from the tools palette onto your stack.
action
	highlight tool "Create Label Field"
	capture the next new field of stack "Mainstack" as "Results"
	wait until there is a field "Results"
	go to step "Set Results Rect"
end step

step "Set Results Rect"
	Resize and position the field as shown.
action
	add guide "Label" with rect "22,287,300,325" to stack "Mainstack"
	highlight guide "Label"
	wait until field "Results" fits guide "Label" with tolerance 3
	go to step "Set Results Properties"
end step

step "Set Results Properties"
	Open the property inspector for the label field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Results"
	go to step "Set Results Name"
end step

step "Set Results Name"
	Set the name of the field to "results".
action
	highlight property "name" of section "Basic"
	wait until the "name" of field "Results" is "results"
	go to step "Set Results Text Alignment"
end step

step "Set Results Text Alignment"
	Set the alignment of the label text to center.
action
	highlight property "textAlign" of section "Text"
	wait until the textAlign of field "Results" is "center"
	go to step "Select Results Field"
end step

step "Select Results Field"
	Select the results field.
action
	highlight field "Results"
	wait until field "Results" is selected
	go to step "Create Advice Field"
end step

step "Create Advice Field"
	Duplicate the results field, by selecting Edit > Duplicate Objects
	from the menubar.
action
	highlight menu item "Duplicate Objects" of menu "Edit"
	capture the next new field of stack "Mainstack" as "Advice"
	wait until there is a field "Advice"
	go to step "Set Advice Rect"
end step

step "Set Advice Rect"
	Resize and position the field as shown.
action
	add guide "Label" with rect "22,327,300,417" to stack "Mainstack"
	highlight guide "Label"
	wait until field "Advice" fits guide "Label" with tolerance 3
	go to step "Set Advice Properties"
end step

step "Set Advice Properties"
	Open the property inspector for the label field.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for field "Advice"
	go to step "Set Advice Name"
end step

step "Set Advice Name"
	Set the name of the field to "advice".
action
	highlight property "name" of section "Basic"
	wait until the "name" of field "Advice" is "advice"
	go to step "Set Advice Dont Wrap"
end step

step "Set Advice Dont Wrap"
	Set the dontWrap property of the advice field to false.
action
	highlight property "dontWrap" of section "Basic"
	wait until the dontWrap of field "Advice" is false
	go to step "Chart Card Interlude"
end step

skip point

step "Chart Card Interlude"
	The UI elements for this part of the app is now complete. Before we 
	start adding code to make things work, we will set up the UI for the
	chart display.
	
	LiveCode stacks can have a number of different cards, which function 
	like separate screens in the app. We are going to add a card for the
	chart display.
action
	interlude
	go to step "Set Calculator Card Properties"
end step

step "Set Calculator Card Properties"
	Open the property inspector for this card by selecting Object > Card 
	Inspector from the menubar.
action
	highlight menu item "Card Inspector" of menu "Object"
	wait until there is an inspector for card "Calculator"
	go to step "Set Calculator Card Name"
end step

step "Set Calculator Card Name"
	Set the name of this card to "calculator"
action
	highlight property "name" of section "Basic"
	wait until the "name" of card "Calculator" is "calculator"
	go to step "Background Groups Interlude"
end step

skip point

step "Background Groups Interlude"
	Sometimes elements of an app's UI should be present on all cards of
	the stack. In our case, the header at the top and the navigation bar
	at the bottom should be visible on the chart card as well as this card.
	
	In order to make this happen, we use a feature of LiveCode called
	a shared group. A shared group can appear on any card of a stack.
action 
	interlude
	go to step "Select Navigation Bar"
end step

step "Select Navigation Bar"
	Select the navigation bar.
action
	highlight widget "Footer"
	wait until widget "Footer" is selected
	go to step "Select Header Bar"
end step

step "Select Header Bar"
	Click on the header bar while holding the shift key to add it to the 
	selection.
action
	highlight widget "Header"
	capture set widget "Header", widget "Footer" as "Shared Controls"
	wait until set "Shared Controls" is selected
	go to step "Group Shared Controls"
end step

step "Group Shared Controls"
	Click "group" to add the controls to a new group.
action
	highlight toolbar "Group"
	capture the next new group of stack "Mainstack" as "Background Group"
	capture set widget "Header", widget "Footer" as "Shared Controls"
	wait until set "Shared Controls" is grouped
	go to step "Set Group Properties"
end step

step "Set Group Properties"
	Open the property inspector for the new group.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for group "Background Group"
	go to step "Set Footer Group Background Behavior"
end step

step "Set Footer Group Background Behavior"
	Set the backgroundBehavior of the group to true.
action
	highlight property "backgroundBehavior" of section "Basic"
	wait until the backgroundBehavior of group "Background Group" is true
	go to step "Create Chart Card"
end step

skip point

step "Create Chart Card"
	We are going to add a new card to the stack, to display a chart of 
	BMI index data. Create a new card.
action
	highlight menu item "New Card" of menu "Object"
	capture the next new card of stack "Mainstack" as "Chart"
	wait until there is a card "Chart"
	go to step "Set Chart Card Properties"
end step

step "Set Chart Card Properties"
	Open the property inspector for this card by selecting Object > Card 
	Inspector from the menubar.
action
	highlight menu item "Card Inspector" of menu "Object"
	wait until there is an inspector for card "Chart"
	go to step "Set Chart Card Name"
end step

step "Set Chart Card Name"
	Set the name of this card to "chart".
action
	highlight property "name" of section "Basic"
	wait until the "name" of card "Chart" is "chart"
	go to step "Import BMI Chart Data"
end step

step "Import BMI Chart Data"
	Import the BMI data from the "bmi.csv" file, by selecting File > 
	Import As Control > Graph from CSV File from the menu bar.
file
	bmi.csv
action
	highlight menu item "Graph from CSV File" of menu item "Import As Control" of menu "File"
	capture the next new widget of stack "Mainstack" as "BMI Chart"
	wait until there is a widget "BMI Chart"
	go to step "Set Chart Properties"
end step

step "Set Chart Properties"
	Open the property inspector for the chart widget.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for widget "BMI Chart"
	go to step "Set Chart Name"
end step

step "Set Chart Name"
	Set the name of the chart widget to "chart".
action
	highlight property "name" of section "Basic"
	wait until the "name" of widget "BMI Chart" is "chart"
	go to step "Set Chart Text Size"
end step

step "Set Chart Text Size"
	Set the text size of the chart widget to 10.
action
	highlight property "textSize" of section "Text"
	wait until the textSize of widget "BMI Chart" is 10
	go to step "Set Chart Rect"
end step

step "Set Chart Rect"
	Resize and position the chart as shown.
action
	add guide "Chart" with rect "0,62,320,432" to stack "Mainstack"
	highlight guide "Chart"
	wait until widget "BMI Chart" fits guide "Chart" with tolerance 3
	go to step "Set Chart Colors"
end step

step "Set Chart Colors"
	Each line on the chart corresponds to a different BMI value. We are
	going to set the colors of the lines appropriately to display that
	information.
	
	Set the graphColors of the chart to
	
	<value>
value
	0,100,255
	0,100,255
	0,150,0
	0,150,0
	0,150,0
	255,128,0
	255,128,0
	255,64,64
	255,64,64	
action
	highlight property "graphColors" of section "Colors"
	wait until the graphColors of widget "BMI Chart" is value
	go to step "Select Navigation Bar Again"
end step

step "Select Navigation Bar Again"
	Select the navigation bar.
action
	highlight widget "Footer"
	wait until widget "Footer" is selected
	go to step "Set Footer Properties Again"
end step

step "Set Footer Properties Again"
	Open the property inspector for the navigation bar.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for widget "Footer"
	go to step "Set Footer Items"
end step

step "Set Footer Items"
	Add a new navigation item to the footer.
action 
	highlight property "navData" of section "Basic"
	wait until the navLabels of widget "Footer" is "Calculator,New Item"
	go to step "Set Item Name"
end step

step "Set Item Name"
	Set the name of the new navigation item to "Chart".
action 
	highlight property "navData" of section "Basic"
	wait until the navLabels of widget "Footer" is "Calculator,Chart"
	go to step "Set Item Icon"
end step

step "Set Item Icon"
	Set the icon of the new navigation item to the bar chart icon.
action 
	highlight property "navData" of section "Basic"
	wait until the navIcons of widget "Footer" is "cog,bar chart"
	go to step "Navigation Bar Script Interlude"
end step

skip point

step "Navigation Bar Script Interlude"
	We're going to add some script to the navigation bar to allow the 
	user to navigate between the Chart and Calculator cards.
action
	interlude
	go to step "Open Navigation Bar Script Editor"
end step

step "Open Navigation Bar Script Editor"
	Click the Code button on the toolbar to open the script editor for
	the navigation bar.
action
	highlight toolbar "Code"
	wait until there is a script editor for widget "Footer"
	go to step "Script Editor Interlude"
end step

step "Script Editor Interlude"
	The Script Editor is a window that allows you to make parts of you 
	app responsive to user actions. 
	
	This is achieved by adding blocks of script which tell LiveCode what 
	to do when a given user action has occurred.
action 
	interlude
	highlight script editor for widget "Footer"
	go to step "Script Editor Apply"
end step

step "Script Editor Apply"
	The script entered into the script editor does not become live 
	until you click on the Apply button. When this is clicked, you will 
	get feedback about whether the script you have written parses 
	correctly or not.
action
	interlude
	highlight "Apply" of script editor for widget "Footer"
	go to step "Script Editor Errors Tab"
end step

step "Script Editor Errors Tab"
	If there are any errors parsing your script, they will appear in the
	errors tab of the script editor. It will tell you where the error
	has occurred. You can double-click the error to navigate to the 
	appropriate line of code.
	
	If there were no errors, it will display the text "No errors 
	occurred".
action
	interlude
	highlight "Errors" of script editor for widget "Footer"
	go to step "Set Navigation Bar Script"
end step

step "Set Navigation Bar Script"
	When an icon on the navigation bar is clicked, it is sent a 
	'navigate' message. Setting the script to the following will cause
	the app to go to the corresponding card of the stack when an icon is
	clicked.
	
	Add the 'go to card' command to the navigation bar script and click
	the Apply button.
script
	on navigate pLabel
		go to card pLabel
	end navigate
action
	highlight script editor for widget "Footer"
	wait until widget "Footer" is scripted
	go to step "Run Edit Tools Interlude"
end step

skip point

step "Run Edit Tools Interlude"
	The browse (aka run) and pointer (aka edit) tools control how you 
	interact with your stack in the IDE. 
	
	In edit mode, you can click or drag to select objects on your stack, 
	or right-click to bring up a contextual menu. In run mode your app 
	is live - objects will behave as they would for the app user. For 
	example, clicking on an object will cause mouseDown and mouseUp 
	messages to be sent to it.
action
	interlude
	highlight tool "Edit Mode"
	go to step "Test Navigation"
end step

step "Test Navigation"
	To demonstrate the code you have just added, we are going to enter
	'run' mode and test navigating between the cards.
action
    highlight tool "Run Mode"
    wait until the tool is run
	go to step "Navigate To Calculator Card"
end step

step "Navigate To Calculator Card"
	Click the 'calculator' navigation item to navigate to the calculator
	card.
action
	highlight widget "Footer"
	wait until this card is "Calculator"
	go to step "Enter Edit Mode"
end step

step "Enter Edit Mode"
	Change the mode back to edit mode to continue making changes to the 
	app.
action
	highlight tool "Edit Mode"
	wait until the tool is edit
	go to step "Open Stack Script"
end step

skip point

step "Open Stack Script"	
	We are going to add a function to the stack script that takes height 
	and weight parameters and uses a web service to return the 
	corresponding BMI.
	
	Open up the stack script editor by clicking the 'Code' icon.
action 
	highlight toolbar "Code"
	wait until there is a script editor for stack "Mainstack"
	go to step "Set Stack Script"
end step

step "Set Stack Script"
	Set the script of the stack to the following:
script
	function getBMI pHeight, pWeight
	   local tURL, tJSon, tArray
	   put "http://api.clinicalcalculator.org/bmi?" & \
		   "height_in_m=" & pHeight & "&weight_in_kg=" & pWeight into tURL
	   put url tURL into tJSon
	   put JsonImport(tJson) into tArray
	   return round(tArray["result"]["value"])
	end getBMI
action
	highlight script editor for stack "Mainstack"
	wait until stack "Mainstack" is scripted
	go to step "Explain URL"
end step

step "Explain URL"
	This url is a web service that takes a query string and returns the 
	result in a JSON array.
action
	interlude
	highlight line "http://api.clinicalcalculator.org/bmi" of script editor for stack "Mainstack"
	go to step "Explain Parameters"
end step

step "Explain Parameters"
	We construct the url with the 'height_in_m' and 'weight_in_kg' 
	parameters, using the contents of the variables pHeight and pWeight.
action
	interlude
	highlight line "&weight_in_kg=" of script editor for stack "Mainstack"
	go to step "Explain Put Url"
end step

step "Explain Put Url"
	The URL syntax can be used to obtain the contents of a web page.
action
	interlude
	highlight line "put url" of script editor for stack "Mainstack"
	go to step "Explain JSON Library"
end step

step "Explain JSON Library"
	The LiveCode IDE comes with a pre-packaged JSON library, which we 
	use to convert the incoming JSON data into a LiveCode array.
action
	interlude
	highlight line "put JsonImport" of script editor for stack "Mainstack"
	go to step "Explain Return"
end step

step "Explain Return"
	Functions should contain a 'return' statement, which returns the
	specified value so it can be used by the caller.
action
	interlude
	highlight line "return" of script editor for stack "Mainstack"
	go to step "Select Calculate Button"
end step

step "Select Calculate Button"
	Select the calculate button. 
action
	highlight button "Calculate"
	wait until button "Calculate" is selected
	go to step "Open Calculate Button Script"
end step

step "Open Calculate Button Script"
	Open the script editor for the button, by clicking the 'Code' 
	toolbar icon.
action
	highlight toolbar "Code"
	wait until there is a script editor for button "Calculate"
	go to step "Set Calculate Button Script"
end step

skip point

step "Set Calculate Button Script"
	When the calculate button is clicked, we want to call the getBMI
	function we added to the stack script using the values that the 
	user has entered in the height and weight fields.

	Set the script of the button to the following:
script
	on mouseUp
		local tHeight
		put field "height" into tHeight
		
		local tWeight
		put field "weight" into tWeight
		
		answer getBMI(tHeight, tWeight)
	end mouseUp
action
	highlight script editor for button "Calculate"
	wait until button "Calculate" is scripted
	go to step "Test Calculate Button"
end step

step "Test Calculate Button"
	To demonstrate the code you have just added, we are going to enter
	'run' mode and test the response of the web service.
action
    highlight tool "Run Mode"
    wait until the tool is run
	go to step "Enter Values And Click"
end step

step "Enter Values And Click"
	Enter numeric values into the height and weight fields, and then
	click the calculate button.
action 
	highlight button "Calculate"
	wait until button "Calculate" pops up answer dialog
	go to step "Re-enter Edit Mode"
end step

step "Re-enter Edit Mode"
	Change the mode back to edit mode to continue making changes to the 
	app.
action
	highlight tool "Edit Mode"
	wait until the tool is edit
	go to step "Custom Properties Interlude"
end step

skip point

step "Custom Properties Interlude"
	When the BMI is calculated, we need a way to store the value in the
	stack so that it is accessible from both cards. To achieve this we
	will use a 'custom property'.
	
	The properties you have been setting on objects so far have been 
	built-in properties. You can set you own (custom) properties on 
	objects and access them in the same way you would a normal property.
action
	interlude
	go to step "Open Calculator Card Script"
end step

step "Open Calculator Card Script"
	We are going to store the calculated BMI using a custom property on
	out stack, called "cBMI". We are also going to store the height and 
	width in custom properties "cHeight" and "cWidth".
	
	To do this we will add a custom command to the card script which 
	will set all the properties for us. So select Object > Card Script 
	from the menubar.
action
	highlight menu item "Card Script" of menu "Object"
	wait until there is a script editor for card "Calculator"
	go to step "Set Calculator Card Script"
end step

step "Set Calculator Card Script"
	Add the following command to the card script:
script
	command calculateBMI
		local tHeight
		put field "height" into tHeight
		set the cHeight of this stack to tHeight
		
		local tWeight
		put field "weight" into tWeight
		set the cWeight of this stack to tWeight
		
		local tBMI
		put getBMI(tHeight, tWeight) into tBMI
		set the cBMI of this stack to tBMI
		
		setData tBMI
	end calculateBMI
	
	command setData pBMI
	  put "Calculated BMI:" && pBMI into field "results"
	  if pBMI <= 18 then
         put "A BMI less than 19 is considered underweight." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "0,0,255"
      else if pBMI <= 24 then
         put "A BMI between 19 and 24 is considered healthy." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "0,255,0"
      else if pBMI <= 29 then
         put "A BMI between 25 and 29 is considered overweight." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "255,255,0"
      else
         put "A BMI over 29 is considered obese." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "255,128,0"
      end if	
      set the opaque of graphic "resultsBG" to true
	end setData
action
	highlight script editor for card "Calculator"
	wait until card "Calculator" is scripted
	go to step "Select Calculate Button Again"
end step

step "Select Calculate Button Again"
	Select the calculate button again.
action
	highlight button "Calculate"
	wait until button "Calculate" is selected
	go to step "Open Calculate Button Script Again"
end step

skip point

step "Open Calculate Button Script Again"
	Open the script editor for the button, by clicking the 'Code' 
	toolbar icon.
action
	highlight toolbar "Code"
	wait until there is a script editor for button "Calculate"
	go to step "Change Calculate Button Script"
end step

step "Change Calculate Button Script"
	Change the button script to call the calculateBMI command you have
	just added to the card script. We will also add some text color when
	the mouse is pressed, to give some user feedback.
script
	on mouseDown
	   set the textColor of me to "0,0,255"
	end mouseDown

	on mouseUp
	   set the textColor of me to empty
	   calculateBMI
	end mouseUp
action
	highlight script editor for button "Calculate"
	wait until button "Calculate" is scripted
	go to step "Test Calculate Button Again"
end step

step "Test Calculate Button Again"
	To demonstrate the code you have just added, we are going to enter
	'run' mode again and click the calculate button.
action
    highlight tool "Run Mode"
    wait until the tool is run
	go to step "Enter Values And Click Again"
end step

step "Enter Values And Click Again"
	Enter numeric values into the height and weight fields, and then
	click the calculate button again.
action 
	highlight button "Calculate"
	wait until button "Calculate" is clicked
	go to step "Re-enter Edit Mode Again"
end step

step "Re-enter Edit Mode Again"
	Change the mode back to edit mode to continue making changes to the 
	app.
action
	highlight tool "Edit Mode"
	wait until the tool is edit
	go to step "Select Header Widget"
end step

step "Select Header Widget"
	All that remains to do on this card is to code the "Clear" action of
	the header widget.
	
	Select the header bar widget.
action
	highlight widget "Header"
	wait until widget "Header" is selected
	go to step "Open Calculator Header Script"
end step

step "Open Calculator Header Script"	
	Open the script editor for the header bar, by clicking the 'Code' 
	toolbar icon.
action
	highlight toolbar "Code"
	wait until there is a script editor for widget "Header"
	go to step "Set Calculator Header Script"
end step

step "Set Calculator Header Script"
	Set the script of the header to the following (you can delete the
	leftAction and searchAction handlers as they will not be used by 
	this widget):
script
	on headerAction pName
	   if pName is "Clear" then
		  put empty into field "height"
		  put empty into field "weight"
		  put empty into field "results"
		  put empty into field "advice"
		  set the backgroundColor of graphic "resultsBG" to" white"
		  set the cBMI of this stack to empty
		  set the cHeight of this stack to empty
		  set the cWidth of this stack to empty
	   end if
	end headerAction
action
	highlight script editor for widget "Header"
	wait until widget "Header" is scripted
	go to step "Go To Chart Card"
end step

step "Go To Chart Card"
	Select View > Go Next to navigate to the chart card.
action
	highlight menu item "Go Next" of menu "View"
	wait until this card is "Chart"
	go to step "Open Chart Card Script"
end step

skip point

step "Open Chart Card Script"
	We are going to use the custom property set on the stack in order to
	highlight where on the chart the last calculated BMI is located.
action
	highlight menu item "Card Script" of menu "Object"
	wait until there is a script editor for card "Chart"
	go to step "Set Chart Card Script"
end step

step "Set Chart Card Script"
	In addition to setting the hilitedCoordinates of the chart, we want 
	to change the title on the header widget and remove the 'Clear'
	action whenever the user navigates to this card. 
	
	Add the following handler to the card script:
script
	on preOpenCard
		if the cBMI of this stack is a number then
			local tCoordinates
			put the cHeight of this stack, the cWeight of this stack into tCoordinates
			set the hilitedCoordinates of widget "chart" to tCoordinates
		else
			set the hilitedCoordinates of widget "chart" to empty
		end if
		
		set the headerActions of widget "header" to empty
		set the headerTitle of widget "header" to "BMI Chart"
	end preOpenCard
action
	highlight script editor for card "Chart"
	wait until card "Chart" is scripted
	go to step "Explain PreOpenCard Script" 
end step

step "Explain PreOpenCard Script"
	The preOpenCard message is sent to a card before it is opened,
	i.e. just before the user navigates to the card.
	
	The preOpenCard handler is normally used to initialise some card 
	state before the user sees it.
action
	interlude
	highlight line "on preOpenCard" of script editor for card "Chart"
	go to step "Script Editor Documentation Pane"
end step

step "Script Editor Documentation Pane"
	The script editor has a documentation pane, which gives some basic 
	information about the piece of syntax the script editor's caret 
	(text insertion cursor) is in.
	
	Try clicking to put the caret in preOpenCard and have a look at the 
	description in the documentation pane.
action 
	interlude
	highlight "Documentation" of script editor for card "Chart"
	go to step "Launch Documentation"
end step

step "Launch Documentation"
	Click the launch documentation button to show the full entry for 
	preOpenCard in the dictionary.
action
	highlight "LaunchDocs" of script editor for card "Chart"
	wait until there is a dictionary
	go to step "Dictionary Interlude"
end step

skip point

step "Dictionary Interlude"
	The dictionary contains information about all the syntax available
	in LiveCode. There is also a guides tab which contains all the user
	guides available.
action
	interlude
	go to step "Dictionary Toolbar"
end step

step "Dictionary Toolbar"
	You can open the dictionary at any time using the toolbar icon.
action
	interlude
	highlight toolbar "Dictionary"
	go to step "Test Navigation Again"
end step

step "Test Navigation Again"
	To demonstrate the effect of the preOpenCard code you have just 
	added, we are going to enter 'run' mode again and navigate back to 
	this card.
action
    highlight tool "Run Mode"
    wait until the tool is run
	go to step "Navigate To Calculator Card Again"
end step

step "Navigate To Calculator Card Again"
	Click the 'Calculator' navigation item to navigate to the calculator
	card.
action
	highlight widget "Footer"
	wait until this card is "Calculator"
	go to step "Navigate To Chart Card"
end step

step "Navigate To Chart Card"
	Click the 'Chart' navigation item to navigate back to the chart 
	card.
action
	highlight widget "Footer"
	wait until this card is "Chart"
	go to step "PreOpenCard Changes"
end step

step "PreOpenCard Changes"
	Notice the title of the header widget has now changed, and the clear
	action has gone. The preOpenCard handler was executed before the 
	card was show, causing the changes to occur.
action
	interlude
	highlight widget "Header"
	go to step "Navigate To Calculator Card A Third Time"
end step

step "Navigate To Calculator Card A Third Time"
	Since the header bar widget is in a shared group, any changes to it
	will be visible from the calculator card as well. So we need to add
	a preOpenCard handler to the calculator card to change the title and
	actions of the header bar widget.
	
	Click the Calculator icon to navigate to the calculator card again.
action
	highlight widget "Footer"
	wait until this card is "Calculator"
	go to step "Enter Edit Mode Again"
end step

step "Enter Edit Mode Again"
	Change the mode back to edit mode to continue making changes to the 
	app.
action
	highlight tool "Edit Mode"
	wait until the tool is edit
	go to step "Open Calculator Card Script Again"
end step

step "Open Calculator Card Script Again"
	Select Object > Card Script from the menubar.
action
	highlight menu item "Card Script" of menu "Object"
	wait until there is a script editor for card "Calculator"
	go to step "Set Calculator Card Script Again"
end step

step "Set Calculator Card Script Again"
	Add the following handler to the card script:
script
	on preOpenCard
		set the actionLabels of widget "header" to "Clear"
		set the headerTitle of widget "header" to "BMI Calculator"
	end preOpenCard
	
	command calculateBMI
		local tHeight
		put field "height" into tHeight
		set the cHeight of this stack to tHeight
		
		local tWeight
		put field "weight" into tWeight
		set the cWeight of this stack to tWeight
		
		local tBMI
		put getBMI(tHeight, tWeight) into tBMI
		set the cBMI of this stack to tBMI
		
		setData tBMI
	end calculateBMI
	
	command setData pBMI
	  put "Calculated BMI:" && pBMI into field "results"
	  if pBMI <= 18 then
         put "A BMI less than 19 is considered underweight." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "0,0,255"
      else if pBMI <= 24 then
         put "A BMI between 19 and 24 is considered healthy." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "0,255,0"
      else if pBMI <= 29 then
         put "A BMI between 25 and 29 is considered overweight." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "255,255,0"
      else
         put "A BMI over 29 is considered obese." into field "advice"
         set the backgroundColor of graphic "resultsBG" to "255,128,0"
      end if	
      set the opaque of graphic "resultsBG" to true
	end setData
action
	highlight script editor for card "Calculator"
	wait until card "Calculator" is scripted
	--go to step "Create Browser Card"
	go to step "Project Browser Interlude"
end step

skip point

step "Project Browser Interlude"
	The project browser is a good way of getting an overview of what's
	in your app. It shows a list of the open stacks with the option to
	unfold the tree view to see the structure of all the objects on the 
	stack. 
	
	Open it using the Tools menu.
action
	highlight menu item "Project Browser" of menu "Tools"
	wait until there is a project browser
	go to step "Project Browser Description"
end step

step "Project Browser Description"
	You can double-click on objects to locate and select them on your 
	stack.
action
	interlude
	highlight project browser
	go to step "Create Browser Card"
end step	

step "Create Browser Card"
	We are going to add one more card to the stack, which will contain
	a browser widget to display the NHS Choices service search website.
action
	highlight menu item "New Card" of menu "Object"
	capture the next new card of stack "Mainstack" as "Browser"
	wait until there is a card "Browser"
	go to step "Set Browser Card Properties"
end step

step "Set Browser Card Properties"
	Open the property inspector for this card.
action
	highlight menu item "Card Inspector" of menu "Object"
	wait until there is an inspector for card "Browser"
	go to step "Set Browser Card Name"
end step

step "Set Browser Card Name"
	Set the name of this card to "browser".
action
	highlight property "name" of section "Basic"
	wait until the "name" of card "Browser" is "browser"
	go to step "Open Browser Card Script"
end step

step "Open Browser Card Script"
	Open the script editor for this card, by selecting "Card Script" 
	from the Object menu.
action	
	highlight menu item "Card Script" of menu "Object"
	wait until there is a script editor for card "Browser"
	go to step "Set Browser Script"
end step

step "Set Browser Script"
	We need to make sure the header bar is updated when the user 
	navigates to this card.
	
	Set the script to the following:
script
	on preOpenCard
		set the headerActions of widget "header" to empty
		set the headerTitle of widget "header" to "NHS Services"
	end preOpenCard
action
	highlight script editor for card "Browser"
	wait until card "Browser" is scripted
	go to step "Select Navigation Bar Once More"
end step

step "Select Navigation Bar Once More"
	Select the navigation bar.
action
	highlight widget "Footer"
	wait until widget "Footer" is selected
	go to step "Set Footer Properties Once More"
end step

step "Set Footer Properties Once More"
	Open the property inspector for the navigation bar.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for widget "Footer"
	go to step "Set Footer Items Once More"
end step

step "Set Footer Items Once More"
	Add a new navigation item to the footer.
action 
	highlight property "navData" of section "Basic"
	wait until the navLabels of widget "Footer" is "Calculator,Chart,New Item"
	go to step "Set Item Name Once More"
end step

step "Set Item Name Once More"
	Set the name of the new navigation item to "Browser".
action 
	highlight property "navData" of section "Basic"
	wait until the navLabels of widget "Footer" is "Calculator,Chart,Browser"
	go to step "Set Item Icon Once More"
end step

step "Set Item Icon Once More"
	Set the icon of the new navigation item to the medikit icon.
action 
	highlight property "navData" of section "Basic"
	wait until the navIcons of widget "Footer" is "cog,bar chart,medkit"
	go to step "Create Browser Widget"
end step

skip point

step "Create Browser Widget"
	One of the built-in widgets in LiveCode 8 is a cross-platform 
	browser object.
	
	Drag a new browser widget from the tools palette onto your stack.
action
	highlight tool "Create com.livecode.widget.browser"
	capture the next new widget of stack "Mainstack" as "Browser"
	wait until there is a widget "Browser"
	go to step "Open Browser Inspector"
end step 

step "Open Browser Inspector"
	Open the property inspector for the browser widget.
action
	highlight toolbar "Inspector"
	wait until there is an inspector for widget "Browser"
	go to step "Set Browser Rect"
end step

step "Set Browser Rect"
	Resize and position the browser as shown.
action
	add guide "Browser" with rect "0,62,320,432" to stack "Mainstack"
	highlight guide "Browser"
	wait until widget "Browser" fits guide "Browser" with tolerance 3
	go to step "Set Browser URL"
end step

step "Set Browser URL"
	Set the url of the browser to "<value>".
value 
	http://www.nhs.uk/service-search
action
	highlight property "url" of section "Basic"
	wait until the url of widget "Browser" is value
	go to step "More Info In Lessons"
end step

skip point

step "More Info In Lessons"
	Congratulations! You have completed this app tutorial. For more 
	practical information on how to make apps in LiveCode, click the
	tutorials toolbar icon for a wealth of step-by-step guides on 
	a wide range of topics.
action
	interlude
	highlight toolbar "Tutorials"
	go to step "Final Browse Mode"
end step

step "Final Browse Mode"
	Finally, enter browse mode and use your app	as it would be by a 
	user. 
action
	highlight tool "Run Mode"
	wait until the tool is run
end step

epilogue
	Once you have made an app, you might want to share it with others.
	LiveCode allows you to deploy the same app to Mac, Windows, Linux, 
	iOS, Android, and HTML5. For more information on building standalone
	applications, see the "Deploying Your Application" guide in the 
	dictionary. Happy coding!
end epilogue